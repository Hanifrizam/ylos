<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YLOS - Youth Leader Organization Summit</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-L9GFQ0GM95"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-L9GFQ0GM95');
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ylosPink: '#FF85B3',
                        ylosYellow: '#FFD700',
                        ylosGreen: '#9ACD32',
                        ylosDark: '#2D3748',
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        .hidden-section { display: none; }
        .active-section { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .blob { position: absolute; filter: blur(40px); z-index: -1; opacity: 0.4; }
        .logo-hover:hover { transform: scale(1.05); transition: transform 0.3s ease; }
        
        div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm {
            background-color: #FF85B3 !important;
            border-radius: 12px;
        }
    </style>
</head>
<body class="font-sans text-gray-700 bg-gray-50 antialiased overflow-x-hidden">

    <nav class="fixed w-full z-50 bg-white/95 backdrop-blur-md shadow-sm transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                
                <div class="flex items-center gap-3 cursor-pointer group flex-shrink-0" onclick="showPage('home')">
                    <img src="LOGO YLOS 5x5.png" alt="Logo" class="h-12 w-auto object-contain logo-hover">
                    <div class="flex flex-col justify-center">
                        <span class="font-extrabold text-xl tracking-tighter text-gray-800 leading-none group-hover:text-ylosPink transition">YLOS</span>
                        <span class="text-[0.5rem] font-bold tracking-widest text-gray-500 uppercase">Youth Leader Summit</span>
                    </div>
                </div>

                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-600 focus:outline-none p-2 hover:bg-gray-100 rounded-lg transition">
                        <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                        </svg>
                    </button>
                </div>

                <div id="nav-desktop-links" class="hidden md:flex items-center space-x-8">
                    <a href="#home" onclick="showPage('home')" class="text-gray-600 hover:text-ylosPink transition font-medium text-sm uppercase tracking-wide">Beranda</a>
                    <a href="#about" onclick="showPage('home')" class="text-gray-600 hover:text-ylosPink transition font-medium text-sm uppercase tracking-wide">Tentang</a>
                    <a href="#trip" onclick="showPage('home')" class="text-gray-600 hover:text-ylosPink transition font-medium text-sm uppercase tracking-wide">Trip</a>
                    <a href="#pricing" onclick="showPage('home')" class="text-gray-600 hover:text-ylosPink transition font-medium text-sm uppercase tracking-wide">Tiket</a>
                    <a href="admin.html" id="nav-desktop-admin" class="hidden text-pink-600 font-bold text-sm border border-pink-200 px-3 py-1 rounded bg-pink-50 hover:bg-pink-100 transition">ADMIN PANEL</a>
                </div>

                <div class="hidden md:block">
                    <div id="nav-public" class="flex items-center gap-3">
                        <button onclick="showPage('login')" class="text-gray-600 hover:text-ylosPink font-bold px-4 py-2 text-sm">Masuk</button>
                        <button onclick="showPage('register')" class="bg-gradient-to-r from-ylosPink to-pink-500 text-white px-5 py-2.5 rounded-full font-bold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition text-sm">Daftar</button>
                    </div>
                    <div id="nav-member" class="hidden flex items-center gap-4">
                        <span id="user-display-name" class="text-sm font-bold text-gray-900">Hi, User</span>
                        
                        <button id="btn-dash-user" onclick="showPage('dashboard')" class="text-ylosPink font-bold text-sm hover:underline">Dashboard</button>
                        <button id="btn-dash-admin" onclick="window.location.href='admin.html'" class="hidden bg-gray-800 text-white px-4 py-2 rounded-full font-bold text-xs hover:bg-black transition">Kontrol Admin</button>
                        
                        <button onclick="logout()" class="border border-red-500 text-red-500 px-4 py-2 rounded-full font-bold hover:bg-red-50 text-xs">Keluar</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100 shadow-lg absolute w-full left-0 top-20 z-40">
            <div class="px-4 pt-4 pb-6 space-y-3 flex flex-col">
                <a href="#home" onclick="mobileLinkClick('home')" class="block px-4 py-3 rounded-xl text-base font-medium text-gray-700 hover:text-ylosPink hover:bg-pink-50 transition">üè† Beranda</a>
                <a href="#about" onclick="mobileLinkClick('home')" class="block px-4 py-3 rounded-xl text-base font-medium text-gray-700 hover:text-ylosPink hover:bg-pink-50 transition">‚ÑπÔ∏è Tentang</a>
                <a href="#trip" onclick="mobileLinkClick('home')" class="block px-4 py-3 rounded-xl text-base font-medium text-gray-700 hover:text-ylosPink hover:bg-pink-50 transition">‚úàÔ∏è Trip</a>
                <a href="#pricing" onclick="mobileLinkClick('home')" class="block px-4 py-3 rounded-xl text-base font-medium text-gray-700 hover:text-ylosPink hover:bg-pink-50 transition">üéüÔ∏è Tiket</a>
                
                <hr class="border-gray-100 my-2">
                
                <div id="mobile-nav-public" class="space-y-3 pt-2">
                    <button onclick="mobileLinkClick('login')" class="w-full text-left px-4 py-3 text-base font-bold text-gray-600 hover:text-ylosPink hover:bg-gray-50 rounded-xl">üîë Masuk</button>
                    <button onclick="mobileLinkClick('register')" class="w-full text-center bg-gradient-to-r from-ylosPink to-pink-500 text-white px-5 py-3 rounded-xl font-bold shadow-md">üöÄ Daftar Akun</button>
                </div>

                <div id="mobile-nav-member" class="hidden space-y-3 pt-2">
                    <div class="px-4 py-3 bg-gray-50 rounded-xl border border-gray-100">
                        <span id="mobile-user-name" class="text-sm font-bold text-gray-900 block">Hi, User</span>
                        <span class="text-xs text-green-600 font-bold">‚óè Online</span>
                    </div>
                    <button id="btn-mobile-dash-user" onclick="mobileLinkClick('dashboard')" class="w-full text-left px-4 py-3 text-base font-bold text-ylosPink hover:bg-pink-50 rounded-xl">üìä Buka Dashboard</button>
                    <button id="btn-mobile-dash-admin" onclick="window.location.href='admin.html'" class="hidden w-full text-left px-4 py-3 text-base font-bold text-gray-800 bg-gray-100 rounded-xl">üõ†Ô∏è Kontrol Admin</button>
                    
                    <button onclick="logout()" class="w-full text-left px-4 py-3 text-base font-bold text-red-500 hover:bg-red-50 rounded-xl">üö™ Keluar</button>
                </div>
            </div>
        </div>
    </nav>

    <div id="page-home" class="active-section">
        <section id="home" class="relative pt-32 pb-16 lg:pt-52 lg:pb-32 overflow-hidden px-4">
            <div class="blob bg-ylosPink/30 w-80 h-80 rounded-full top-0 left-0 -translate-x-1/2 -translate-y-1/2 blur-3xl"></div>
            <div class="blob bg-ylosYellow/30 w-60 h-60 rounded-full bottom-0 right-0 translate-x-1/3 translate-y-1/3 blur-3xl"></div>

            <div class="max-w-7xl mx-auto text-center relative z-10">
                <div class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-white border border-gray-200 shadow-sm mb-8 animate-bounce">
                    <span class="flex h-2 w-2 relative">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-ylosGreen opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-ylosGreen"></span>
                    </span>
                    <span class="text-xs font-bold tracking-wide text-gray-600 uppercase">Pendaftaran Batch 1 Dibuka</span>
                </div>
                
                <h1 class="text-4xl md:text-7xl font-extrabold text-gray-900 tracking-tight mb-6 leading-tight">
                    Unlock Your <span class="text-transparent bg-clip-text bg-gradient-to-r from-ylosPink to-purple-600">Leadership.</span> <br>
                    Explore the <span class="text-transparent bg-clip-text bg-gradient-to-r from-ylosGreen to-teal-500">World.</span>
                </h1>
                
                <p class="mt-4 md:mt-6 text-lg md:text-xl text-gray-500 max-w-2xl mx-auto mb-8 md:mb-10 leading-relaxed px-2">
                    Youth Leader Organization Summit (YLOS) mengajak siswa SMA/SMK untuk mengasah potensi kepemimpinan sambil studi banding internasional.
                </p>
                
                <div class="flex flex-col sm:flex-row justify-center gap-4 px-4">
                    <button onclick="showPage('register')" class="bg-gray-900 text-white px-8 py-4 rounded-full font-bold text-lg shadow-xl hover:bg-gray-800 transition transform hover:-translate-y-1 w-full sm:w-auto">Amankan Kursi</button>
                    <a href="#trip" class="bg-white text-gray-900 border border-gray-200 px-8 py-4 rounded-full font-bold text-lg shadow-sm hover:bg-gray-50 transition flex items-center justify-center gap-2 group w-full sm:w-auto">
                        Lihat Tujuan Trip <span class="group-hover:translate-x-1 transition-transform">‚úàÔ∏è</span>
                    </a>
                </div>
            </div>
        </section>

        <section id="about" class="py-16 md:py-24 bg-gray-50/50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900">Kenapa Kamu Harus Join YLOS?</h2>
                    <div class="h-1 w-20 bg-ylosYellow mx-auto mt-4 rounded-full"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                    <div class="bg-white p-6 md:p-8 rounded-3xl shadow-sm hover:shadow-xl border border-gray-100 hover:border-ylosPink transition duration-300 group">
                        <div class="w-16 h-16 bg-pink-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-ylosPink transition-colors">
                            <span class="text-2xl text-ylosPink group-hover:text-white">ü§ù</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-gray-900">Leadership & Network</h3>
                        <p class="text-gray-600 leading-relaxed">Bertemu dengan ratusan pemimpin muda se-Indonesia dan bangun jaringan profesional.</p>
                    </div>
                    <div class="bg-white p-6 md:p-8 rounded-3xl shadow-sm hover:shadow-xl border border-gray-100 hover:border-ylosYellow transition duration-300 group">
                        <div class="w-16 h-16 bg-yellow-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-ylosYellow transition-colors">
                            <span class="text-2xl text-yellow-600 group-hover:text-white">üí°</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-gray-900">Critical Thinking</h3>
                        <p class="text-gray-600 leading-relaxed">Asah kemampuan memecahkan masalah melalui studi kasus nyata dan mentoring eksklusif.</p>
                    </div>
                    <div class="bg-white p-6 md:p-8 rounded-3xl shadow-sm hover:shadow-xl border border-gray-100 hover:border-ylosGreen transition duration-300 group">
                        <div class="w-16 h-16 bg-green-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-ylosGreen transition-colors">
                            <span class="text-2xl text-ylosGreen group-hover:text-white">üåç</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-gray-900">Global Experience</h3>
                        <p class="text-gray-600 leading-relaxed">Perluas wawasan dengan kunjungan ke universitas top dunia dan perusahaan multinasional.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="trip" class="py-16 md:py-24 relative overflow-hidden bg-gray-900">
            <div class="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-ylosPink opacity-10 rounded-full blur-3xl"></div>
            <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-96 h-96 bg-ylosGreen opacity-10 rounded-full blur-3xl"></div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 flex flex-col lg:flex-row items-center gap-10 lg:gap-16">
                <div class="lg:w-1/2 text-white">
                    <span class="text-ylosYellow font-bold tracking-wider uppercase text-sm mb-2 block">Highlight Program</span>
                    <h2 class="text-3xl md:text-5xl font-extrabold mb-6 leading-tight">International Trip: <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-ylosYellow to-orange-400">Singapore & Malaysia</span></h2>
                    <p class="text-gray-300 text-lg mb-8 leading-relaxed">Rasakan pengalaman belajar langsung di negara tetangga. Bukan sekadar jalan-jalan, tapi membuka mata akan peluang global.</p>
                    <div class="space-y-6">
                        <div class="flex items-start gap-4">
                            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm"><span class="text-2xl">üéì</span></div>
                            <div><h4 class="font-bold text-xl">University Visit</h4><p class="text-gray-400 text-sm">Kunjungan ke kampus terbaik (NTU/NUS/UM).</p></div>
                        </div>
                        <div class="flex items-start gap-4">
                            <div class="bg-white/10 p-3 rounded-lg backdrop-blur-sm"><span class="text-2xl">üè¢</span></div>
                            <div><h4 class="font-bold text-xl">Company Visit</h4><p class="text-gray-400 text-sm">Melihat budaya kerja perusahaan global.</p></div>
                        </div>
                    </div>
                </div>
                <div class="lg:w-1/2 w-full">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-tr from-ylosPink to-ylosYellow rounded-2xl transform rotate-6 opacity-30"></div>
                        <div class="relative rounded-2xl overflow-hidden shadow-2xl border-4 border-white/10">
                            <img src="https://images.unsplash.com/photo-1565967511849-76a60a516170?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Singapore" class="w-full h-auto object-cover transform hover:scale-105 transition duration-700">
                            <div class="absolute bottom-0 left-0 bg-gradient-to-t from-black/80 to-transparent w-full p-6 md:p-8">
                                <p class="text-white font-bold text-lg md:text-xl">üìç Marina Bay Sands, Singapore</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="pricing" class="py-16 md:py-24 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4">Pilih Paket Perjalananmu</h2>
                <p class="text-gray-500 mb-8 md:mb-12">Investasi sekali untuk pengalaman seumur hidup.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 max-w-4xl mx-auto">
                    <div class="border border-gray-200 rounded-[2rem] p-6 md:p-8 hover:shadow-xl transition relative bg-white flex flex-col">
                        <div class="mb-4 text-left"><span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">Basic</span></div>
                        <h3 class="text-2xl font-bold text-gray-900 text-left">Regular Pass</h3>
                        <div class="text-left mt-2 mb-6"><span class="text-3xl md:text-4xl font-extrabold text-gray-900">IDR 3.500k</span></div>
                        <ul class="text-left space-y-4 mb-8 text-gray-600 flex-1">
                            <li class="flex items-center gap-3"><span class="text-green-500">‚úì</span> Akses Materi</li>
                            <li class="flex items-center gap-3"><span class="text-green-500">‚úì</span> Hotel Bintang 3</li>
                            <li class="flex items-center gap-3"><span class="text-green-500">‚úì</span> Tiket Pesawat Ekonomi</li>
                            <li class="flex items-center gap-3"><span class="text-green-500">‚úì</span> Sertifikat Nasional</li>
                        </ul>
                        <button onclick="showPage('register')" class="block w-full py-4 rounded-xl border-2 border-gray-900 font-bold text-gray-900 hover:bg-gray-900 hover:text-white transition text-center">Pilih Regular</button>
                    </div>

                    <div class="border-2 border-ylosPink rounded-[2rem] p-6 md:p-8 shadow-2xl relative bg-white flex flex-col transform md:-translate-y-4">
                        <div class="absolute top-0 right-0 bg-ylosPink text-white text-xs font-bold px-4 py-2 rounded-bl-2xl rounded-tr-[1.8rem]">BEST VALUE</div>
                        <div class="mb-4 text-left"><span class="bg-pink-100 text-ylosPink px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">Recommended</span></div>
                        <h3 class="text-2xl font-bold text-gray-900 text-left">VIP Delegate</h3>
                        <div class="text-left mt-2 mb-6"><span class="text-3xl md:text-4xl font-extrabold text-gray-900">IDR 4.800k</span></div>
                        <ul class="text-left space-y-4 mb-8 text-gray-600 flex-1">
                            <li class="flex items-center gap-3"><strong>‚úì Priority Seating</strong></li>
                            <li class="flex items-center gap-3">‚úì Hotel Bintang 4</li>
                            <li class="flex items-center gap-3">‚úì Tiket Pesawat & Bagasi</li>
                            <li class="flex items-center gap-3"><strong>‚úì Sertifikat Internasional</strong></li>
                            <li class="flex items-center gap-3">‚úì Exclusive Merchandise Kit</li>
                        </ul>
                        <button onclick="showPage('register')" class="block w-full py-4 rounded-xl bg-gradient-to-r from-ylosPink to-pink-600 text-white font-bold hover:shadow-lg hover:to-pink-700 transition text-center">Daftar VIP Sekarang</button>
                    </div>
                </div>
            </div>
        </section>

        <footer class="bg-gray-900 text-white pt-16 pb-8 border-t border-gray-800">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <div class="mb-6 flex justify-center items-center gap-3">
                    <img src="LOGO YLOS 5x5.png" alt="Logo" class="h-10 w-auto brightness-200 grayscale hover:grayscale-0 hover:brightness-100 transition duration-500">
                    <span class="font-bold text-xl tracking-tight">YLOS 2025</span>
                </div>
                <p class="text-gray-400 mb-8 max-w-md mx-auto text-sm">Platform pengembangan kepemimpinan pemuda nomor 1 di Indonesia.</p>
                <div class="border-t border-gray-800 pt-8">
                    <p class="text-gray-600 text-xs">¬© 2025 Youth Leader Organization Summit.</p>
                </div>
            </div>
        </footer>
    </div>

    <div id="page-login" class="hidden-section pt-32 pb-20 min-h-screen px-4">
        <div class="max-w-md mx-auto bg-white p-6 md:p-8 rounded-3xl shadow-xl border border-gray-100">
            <h2 class="text-3xl font-bold text-center mb-6">Masuk Kembali üëã</h2>
            <form onsubmit="handleLogin(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-1">Email</label>
                    <input type="email" id="login-email" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                </div>
                <div>
                    <div class="flex justify-between items-center mb-1">
                        <label class="block text-sm font-bold">Password</label>
                        <a href="reset.html" class="text-xs text-ylosPink hover:underline">Lupa Password?</a>
                    </div>
                    <input type="password" id="login-password" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                </div>
                <button type="submit" class="w-full bg-gray-900 text-white font-bold py-3 rounded-xl hover:bg-gray-800 transition">Masuk</button>
            </form>
            <p class="text-center mt-4 text-sm">Belum punya akun? <button onclick="showPage('register')" class="text-ylosPink font-bold hover:underline">Daftar disini</button></p>
        </div>
    </div>

    <div id="page-register" class="hidden-section pt-32 pb-20 min-h-screen px-4">
        <div class="max-w-lg mx-auto bg-white p-6 md:p-8 rounded-3xl shadow-xl border border-gray-100">
            <h2 class="text-3xl font-bold text-center mb-2">Daftar YLOS üöÄ</h2>
            <p class="text-center text-gray-500 mb-6">Isi data dirimu untuk membuat akun.</p>
            
            <form onsubmit="handleRegister(event)" class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-1">Nama Lengkap</label>
                    <input type="text" id="reg-name" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-1">Asal Sekolah</label>
                        <input type="text" id="reg-school" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-1">No. WhatsApp</label>
                        <input type="tel" id="reg-phone" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-bold mb-1">Email</label>
                    <input type="email" id="reg-email" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                </div>
                <div>
                    <label class="block text-sm font-bold mb-1">Password</label>
                    <input type="password" id="reg-password" required class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none">
                </div>
                <div>
                    <label class="block text-sm font-bold mb-1">Pilih Paket</label>
                    <select id="reg-package" class="w-full px-4 py-3 rounded-lg border focus:border-ylosPink outline-none bg-white">
                        <option value="Regular Pass">Regular Pass - IDR 3.500k</option>
                        <option value="VIP Delegate">VIP Delegate - IDR 4.800k</option>
                    </select>
                </div>

                <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                    <label class="block text-sm font-bold mb-2 text-gray-700">Verifikasi Keamanan</label>
                    <div class="flex items-center gap-4">
                        <div id="captcha-question" class="bg-gray-200 text-gray-800 px-4 py-3 rounded-lg font-mono font-bold text-lg select-none tracking-widest min-w-[100px] text-center">...</div>
                        <input type="number" id="captcha-input" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-ylosPink outline-none transition" placeholder="Hasil?">
                    </div>
                    <p class="text-xs text-gray-400 mt-2">*Hitung penjumlahan di atas untuk lanjut.</p>
                </div>

                <button type="submit" id="btn-reg" class="w-full bg-ylosPink text-white font-bold py-3 rounded-xl hover:bg-pink-600 transition">Daftar Sekarang</button>
            </form>
            <p class="text-center mt-4 text-sm">Sudah punya akun? <button onclick="showPage('login')" class="text-ylosPink font-bold hover:underline">Login disini</button></p>
        </div>
    </div>

    <div id="page-dashboard" class="hidden-section pt-24 pb-20 min-h-screen">
        <div class="max-w-6xl mx-auto px-4 md:px-6">
            
            <div class="bg-gradient-to-r from-ylosPink to-ylosYellow rounded-3xl p-6 md:p-8 text-white mb-10 shadow-lg relative overflow-hidden">
                <div class="relative z-10">
                    <h2 class="text-2xl md:text-3xl font-bold mb-2">Halo, <span id="dash-name">Leader!</span> üëã</h2>
                    <p class="opacity-90 text-sm md:text-base">Selamat datang di dashboard peserta YLOS 2025.</p>
                </div>
                <div class="absolute right-0 top-0 h-full w-1/2 bg-white opacity-10 skew-x-12 transform translate-x-20"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                
                <div class="md:col-span-1 space-y-6">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 h-fit">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Invoice & Payment</h3>
                        <div class="space-y-4">
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-xs text-gray-500 uppercase font-bold">Paket Dipilih</p>
                                <p id="dash-package" class="text-lg font-bold text-ylosPink">Loading...</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-xs text-gray-500 uppercase font-bold">Status Pembayaran</p>
                                <span id="dash-status" class="inline-block mt-1 px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-bold">Loading...</span>
                            </div>
                            
                            <div id="payment-actions">
                                <button onclick="openLynkPayment()" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 rounded-xl font-bold text-sm hover:shadow-lg transition flex items-center justify-center gap-2 shadow-md animate-pulse">
                                    üí≥ Bayar & Finalisasi
                                </button>
                                <p class="text-center text-xs text-gray-400 mt-2">Via LYNK (Aman & Terpercaya)</p>
                                <button onclick="contactAdmin()" class="w-full mt-2 border border-gray-300 text-gray-500 py-2 rounded-lg font-bold text-xs hover:bg-gray-50">Butuh Bantuan? Chat Admin</button>
                            </div>
                            
                            <div id="wa-group-access" class="hidden space-y-3">
                                <button onclick="joinWaGroup()" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold text-sm hover:bg-green-600 transition flex items-center justify-center gap-2 shadow-lg">
                                    <i class="fa-brands fa-whatsapp text-lg"></i> Gabung Grup WhatsApp
                                </button>
                                <p class="text-xs text-green-600 text-center font-bold">Akses Khusus Member Lunas</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">üì¢ Status Akun</h3>
                        <div class="border-l-4 border-ylosPink bg-pink-50 p-4 rounded-r-lg">
                            <p id="dash-announce-title" class="font-bold text-gray-800">Menunggu Pembayaran</p>
                            <p id="dash-announce-desc" class="text-sm text-gray-600 mt-1">Silakan klik tombol bayar. Setelah membayar, admin akan memverifikasi data kamu (Maks. 1x24 Jam).</p>
                        </div>
                    </div>
                </div>

                <div class="md:col-span-2 space-y-6">
                    
                    <div id="announcement-container" class="hidden bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-bell text-pink-500"></i> Pengumuman Terbaru
                        </h3>
                        <div id="announcement-content" class="space-y-4">
                            </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-book-open text-purple-600"></i> Modul & Materi
                        </h3>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 border rounded-xl hover:bg-gray-50 cursor-pointer">
                                <div class="flex items-center gap-3">
                                    <div class="bg-blue-100 p-2 rounded-lg text-blue-600"><i class="fa-solid fa-file-pdf"></i></div>
                                    <div><p class="font-bold text-sm">Rundown Acara</p><p class="text-xs text-gray-400">Public Access</p></div>
                                </div>
                                <span class="text-ylosPink text-sm font-bold">Download</span>
                            </div>

                            <div id="modules-content" class="space-y-3">
                                <p class="text-center text-sm text-gray-400 py-4">Belum ada materi tambahan.</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script>
        // 1. SUPABASE
        const supabaseClient = supabase.createClient(
            'https://jrslgkxwjvugvgakxwsd.supabase.co', 
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impyc2xna3h3anZ1Z3ZnYWt4d3NkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4MTYyNDYsImV4cCI6MjA4NTM5MjI0Nn0.q2GGd0kdKt7KGWt7QpfeP0UUBOStmuUH51caPoCrmMk'
        );
        
        // 2. CONFIG
        const LYNK_PAYMENT_URL = "https://youthleaderorganizationsummit.id/ylos.id/er400x4wrlp1/checkout?token=cGFyYW1zPSU1QiU1RCZiaWRfcHJpY2U9MCZxdHlfcHJvZD0x";
        const WA_GROUP_LINK = "https://chat.whatsapp.com/GANTIDENGANLINKGRUPMU"; 
        
        let userSession = null;
        let captchaCorrectAnswer = 0;

        // 3. UTILS
        function generateCaptcha() {
            const n1 = Math.floor(Math.random()*10)+1, n2 = Math.floor(Math.random()*10)+1;
            captchaCorrectAnswer = n1 + n2;
            document.getElementById('captcha-question').innerText = `${n1} + ${n2} = ?`;
            document.getElementById('captcha-input').value = '';
        }

        function showPage(pageId) {
            if (userSession && (pageId === 'login' || pageId === 'register')) pageId = 'dashboard';
            if (pageId === 'register') generateCaptcha();

            ['page-home', 'page-login', 'page-register', 'page-dashboard'].forEach(id => {
                document.getElementById(id).classList.remove('active-section');
                document.getElementById(id).classList.add('hidden-section');
            });
            document.getElementById('page-' + pageId).classList.remove('hidden-section');
            document.getElementById('page-' + pageId).classList.add('active-section');
            document.getElementById('mobile-menu').classList.add('hidden');
            window.scrollTo(0,0);
        }
        
        function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }
        function mobileLinkClick(id) { showPage(id); }

        // 4. AUTH
        async function handleRegister(e) {
            e.preventDefault();
            
            if(parseInt(document.getElementById('captcha-input').value) !== captchaCorrectAnswer) {
                Swal.fire({ icon: 'error', title: 'Captcha Salah!', text: 'Silakan hitung ulang penjumlahan.' });
                generateCaptcha(); return;
            }

            const btn = document.getElementById('btn-reg'); 
            btn.innerText='Memproses...'; btn.disabled=true;
            
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            
            // CEK EMAIL MANUAL (BYPASS)
            try {
                const { data: isEmailExist } = await supabaseClient.rpc('check_email_exists', { email_input: email });
                if (isEmailExist === true) {
                    Swal.fire({ 
                        icon: 'warning', 
                        title: 'Email Sudah Terdaftar! ‚ö†Ô∏è', 
                        html: `Email <b>${email}</b> sudah ada di sistem.<br>Silakan langsung login saja.`,
                        showCancelButton: true, confirmButtonText: 'Login Sekarang', cancelButtonText: 'Coba Email Lain', confirmButtonColor: '#FF85B3'
                    }).then((result) => { if (result.isConfirmed) showPage('login'); });
                    btn.innerText='Daftar Sekarang'; btn.disabled=false; generateCaptcha(); return;
                }
            } catch (err) { console.log("Gagal cek email:", err); }

            const metadata = {
                full_name: document.getElementById('reg-name').value,
                school: document.getElementById('reg-school').value,
                phone: document.getElementById('reg-phone').value,
                package_type: document.getElementById('reg-package').value
            };

            const { data, error } = await supabaseClient.auth.signUp({ 
                email: email, password: password,
                options: { emailRedirectTo: 'https://ylos.site', data: metadata }
            });

            if(error) { 
                Swal.fire({ icon: 'error', title: 'Gagal Daftar', text: error.message });
                btn.innerText='Daftar Sekarang'; btn.disabled=false; generateCaptcha(); return; 
            }

            if(data.user) {
                Swal.fire({ 
                    icon: 'success', title: 'Berhasil Mendaftar!', 
                    html: `Link verifikasi telah dikirim ke <b>${email}</b>.<br>Cek Inbox/Spam, klik linknya, lalu login.`,
                    confirmButtonText: 'Siap!'
                }).then(() => showPage('login'));
            }
            btn.innerText='Daftar Sekarang'; btn.disabled=false;
        }

        async function handleLogin(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button'); 
            const originalText = btn.innerText;
            btn.innerText = "Loading...";
            
            const { data, error } = await supabaseClient.auth.signInWithPassword({
                email: document.getElementById('login-email').value,
                password: document.getElementById('login-password').value
            });
            
            if(error) {
                let msg = error.message;
                if (msg.includes("Email not confirmed")) msg = "Email belum diverifikasi. Cek inbox/spam email kamu.";
                Swal.fire({ icon: 'error', title: 'Login Gagal', text: msg });
                btn.innerText = originalText;
            } else {
                // SUKSES: Tampilkan Popup dulu sebelum pindah halaman
                btn.innerText = "Sukses!";
                Swal.fire({
                    icon: 'success',
                    title: 'Login Berhasil! üëã',
                    text: 'Selamat datang kembali di YLOS.',
                    timer: 1500,
                    showConfirmButton: false
                });
                // onAuthStateChange akan otomatis jalan setelah ini
            }
        }

       async function logout() {
            // Gunakan 'await' pada Swal agar reload menunggu popup selesai tampil
            await Swal.fire({ 
                icon: 'success', 
                title: 'Logout Berhasil', 
                text: 'Sampai jumpa lagi!', 
                timer: 1500, 
                showConfirmButton: false 
            });
            
            await supabaseClient.auth.signOut();
            userSession = null;
            window.location.reload(); // Reload baru jalan setelah popup selesai
        }

        function openLynkPayment() {
            Swal.fire({
                title: 'Pembayaran Dibuka üí≥',
                html: `Anda akan diarahkan ke halaman pembayaran aman via <b>LYNK</b>.`,
                imageUrl: 'LOGO YLOS 5x5.png', imageWidth: 80, imageHeight: 80,
                showCancelButton: true, confirmButtonText: 'Lanjut Bayar ‚ûî', cancelButtonText: 'Batal', confirmButtonColor: '#FF85B3', cancelButtonColor: '#d33'
            }).then((result) => { if (result.isConfirmed) window.open(LYNK_PAYMENT_URL, '_blank'); });
        }

        function joinWaGroup() { window.open(WA_GROUP_LINK, '_blank'); }
        function contactAdmin() { window.open(`https://wa.me/6281234567890?text=Halo Admin, saya butuh bantuan.`, '_blank'); }

        // 5. DASHBOARD & CMS LOGIC
        async function loadDashboard(userId) {
            const { data: profile } = await supabaseClient.from('profiles').select('*').eq('id', userId).single();
            if(profile) {
                document.getElementById('dash-name').innerText = profile.full_name;
                document.getElementById('mobile-user-name').innerText = profile.full_name;
                document.getElementById('dash-package').innerText = profile.package_type;
                
                const els = {
                    badge: document.getElementById('dash-status'),
                    actions: document.getElementById('payment-actions'),
                    wa: document.getElementById('wa-group-access'),
                    title: document.getElementById('dash-announce-title'),
                    desc: document.getElementById('dash-announce-desc')
                };

                const isLunas = profile.payment_status === 'Lunas';

                if(isLunas) {
                    els.badge.innerText = 'LUNAS (Verified)';
                    els.badge.className = 'inline-block mt-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-bold';
                    els.actions.classList.add('hidden');
                    els.wa.classList.remove('hidden');
                    els.title.innerText = "Selamat Datang, Delegates!";
                    els.desc.innerText = "Akunmu sudah aktif.";
                } else {
                    els.badge.innerText = 'Menunggu Pembayaran';
                    els.badge.className = 'inline-block mt-1 px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-bold';
                    els.actions.classList.remove('hidden');
                    els.wa.classList.add('hidden');
                }

                // CHECK ADMIN ROLE
                if(profile.role === 'admin') {
                    // Tampilkan link Admin di Desktop
                    document.getElementById('nav-desktop-admin').classList.remove('hidden');
                    
                    // Logic Desktop: Sembunyikan Dashboard, Tampilkan Kontrol Admin
                    document.getElementById('btn-dash-user').classList.add('hidden');
                    document.getElementById('btn-dash-admin').classList.remove('hidden');

                    // Logic Mobile: Sama
                    document.getElementById('btn-mobile-dash-user').classList.add('hidden');
                    document.getElementById('btn-mobile-dash-admin').classList.remove('hidden');
                } else {
                    // User Biasa
                    document.getElementById('nav-desktop-admin').classList.add('hidden');
                    document.getElementById('btn-dash-user').classList.remove('hidden');
                    document.getElementById('btn-dash-admin').classList.add('hidden');
                    document.getElementById('btn-mobile-dash-user').classList.remove('hidden');
                    document.getElementById('btn-mobile-dash-admin').classList.add('hidden');
                }

                // LOAD KONTEN CMS
                loadCMSContent(isLunas);
            }
        }

        async function loadCMSContent(isLunas) {
            // A. PENGUMUMAN
            const { data: announcements } = await supabaseClient
                .from('announcements')
                .select('*')
                .eq('is_active', true)
                .order('created_at', {ascending: false});
            
            if(announcements && announcements.length > 0) {
                document.getElementById('announcement-container').classList.remove('hidden');
                const container = document.getElementById('announcement-content');
                container.innerHTML = '';
                announcements.forEach(ann => {
                    container.innerHTML += `
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                            <h4 class="font-bold text-gray-800 text-sm">${ann.title}</h4>
                            <p class="text-sm text-gray-600 mt-1">${ann.content}</p>
                            <span class="text-xs text-gray-400 mt-2 block">${new Date(ann.created_at).toLocaleDateString()}</span>
                        </div>
                    `;
                });
            }

            // B. MODUL
            const { data: modules } = await supabaseClient
                .from('modules')
                .select('*')
                .order('created_at', {ascending: false});
            
            const modContainer = document.getElementById('modules-content');
            if(modules && modules.length > 0) {
                modContainer.innerHTML = '';
                modules.forEach(mod => {
                    let isLocked = mod.is_premium && !isLunas;
                    let icon = mod.category === 'Video' ? 'fa-play-circle' : 'fa-file-alt';
                    let action = isLocked 
                        ? `<span class="text-xs bg-gray-200 text-gray-500 px-2 py-1 rounded"><i class="fa-solid fa-lock"></i> Locked</span>`
                        : `<a href="${mod.link_url}" target="_blank" class="text-xs font-bold text-white bg-purple-600 px-3 py-1 rounded hover:bg-purple-700">Buka</a>`;
                    
                    let opacity = isLocked ? 'opacity-60 grayscale' : '';

                    modContainer.innerHTML += `
                        <div class="flex items-center justify-between p-3 border rounded-xl bg-white hover:shadow-sm transition ${opacity}">
                            <div class="flex items-center gap-3">
                                <div class="bg-purple-100 w-8 h-8 rounded-lg flex items-center justify-center text-purple-600 text-sm">
                                    <i class="fa-solid ${icon}"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800 text-sm line-clamp-1">${mod.title}</h4>
                                    <p class="text-xs text-gray-500">${mod.category}</p>
                                </div>
                            </div>
                            ${action}
                        </div>
                    `;
                });
            }
        }

        // 6. SESSION LISTENER
        supabaseClient.auth.onAuthStateChange((event, session) => {
            userSession = session;
            if(event === 'PASSWORD_RECOVERY') { window.location.href = 'reset.html'; return; }
            
            const els = {
                dp: document.getElementById('nav-public'), dm: document.getElementById('nav-member'),
                mp: document.getElementById('mobile-nav-public'), mm: document.getElementById('mobile-nav-member')
            };

            if(session) {
                els.dp.classList.add('hidden'); els.mp.classList.add('hidden');
                els.dm.classList.remove('hidden'); els.mm.classList.remove('hidden');
                document.getElementById('user-display-name').innerText = session.user.email;
                loadDashboard(session.user.id);
                if(window.location.hash !== '#home') showPage('dashboard');
            } else {
                els.dp.classList.remove('hidden'); els.mp.classList.remove('hidden');
                els.dm.classList.add('hidden'); els.mm.classList.add('hidden');
                if(!document.getElementById('page-login').classList.contains('active-section') && !document.getElementById('page-register').classList.contains('active-section')) showPage('home');
            }
        });
    </script>
</body>
</html>
